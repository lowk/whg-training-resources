<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-data_visualisation/data_visualisation_with_ggplot2/dataviz">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.20">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><title data-rh="true">Data visualisation with tidyverse | WHG training resources</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://well.ox.ac.uk//whg-training-resources/data_visualisation/data_visualisation_with_ggplot2/dataviz/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Data visualisation with tidyverse | WHG training resources"><meta data-rh="true" name="description" content="In this tutorial we will explore data visualisation using the R packages"><meta data-rh="true" property="og:description" content="In this tutorial we will explore data visualisation using the R packages"><link data-rh="true" rel="icon" href="/whg-training-resources/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://well.ox.ac.uk//whg-training-resources/data_visualisation/data_visualisation_with_ggplot2/dataviz/"><link data-rh="true" rel="alternate" href="https://well.ox.ac.uk//whg-training-resources/data_visualisation/data_visualisation_with_ggplot2/dataviz/" hreflang="en"><link data-rh="true" rel="alternate" href="https://well.ox.ac.uk//whg-training-resources/data_visualisation/data_visualisation_with_ggplot2/dataviz/" hreflang="x-default"><link rel="stylesheet" href="/whg-training-resources/assets/css/styles.b827ae01.css">
<link rel="preload" href="/whg-training-resources/assets/js/runtime~main.50846bb3.js" as="script">
<link rel="preload" href="/whg-training-resources/assets/js/main.1b628545.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/whg-training-resources/"><div class="navbar__logo"><img src="/whg-training-resources/img/wchg.png" alt="My Site Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/whg-training-resources/img/wchg.png" alt="My Site Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title text--truncate">Training Resources</b></a><a class="navbar__item navbar__link navbar__link--active" href="/whg-training-resources/overview/">Click here for the tutorials</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/whg-training/whg-training-resources" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_dLyj"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_mKqt"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><div class="docPage_ualW"><aside class="theme-doc-sidebar-container docSidebarContainer_UQUJ"><div class="sidebar_RiAD"><nav class="menu thin-scrollbar menu_izAj"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/whg-training-resources/overview/">Overview of the tutorials</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/whg-training-resources/prerequisites/">Getting your environment setup</a><button aria-label="Toggle the collapsible sidebar category &#x27;Getting your environment setup&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/whg-training-resources/bioinformatics/">Bioinformatics</a><button aria-label="Toggle the collapsible sidebar category &#x27;Bioinformatics&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/whg-training-resources/programming/">Programming</a><button aria-label="Toggle the collapsible sidebar category &#x27;Programming&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/whg-training-resources/data_visualisation/">Data visualisation</a><button aria-label="Toggle the collapsible sidebar category &#x27;Data visualisation&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/whg-training-resources/data_visualisation/visualising_rna-seq_data/">Visualising RNA-seq data in R</a><button aria-label="Toggle the collapsible sidebar category &#x27;Visualising RNA-seq data in R&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/whg-training-resources/data_visualisation/data_visualisation_with_ggplot2/">Visualisation with ggplot2</a><button aria-label="Toggle the collapsible sidebar category &#x27;Visualisation with ggplot2&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/whg-training-resources/data_visualisation/data_visualisation_with_ggplot2/dataviz/">Data visualisation with tidyverse</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/whg-training-resources/next_generation_sequencing/">Next-generation sequencing</a><button aria-label="Toggle the collapsible sidebar category &#x27;Next-generation sequencing&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/whg-training-resources/statistical_modelling/">Statistical modelling</a><button aria-label="Toggle the collapsible sidebar category &#x27;Statistical modelling&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/whg-training-resources/population_genetics/">Population genetics</a><button aria-label="Toggle the collapsible sidebar category &#x27;Population genetics&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/whg-training-resources/genome_wide_association_studies/">Genome-wide association analysis</a><button aria-label="Toggle the collapsible sidebar category &#x27;Genome-wide association analysis&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/whg-training-resources/LICENSE/">LICENSE</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/whg-training-resources/contributors/">contributors</a></li></ul></nav></div></aside><main class="docMainContainer_uL0j"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/whg-training-resources/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_kU5B"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/whg-training-resources/data_visualisation/"><span itemprop="name">Data visualisation</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/whg-training-resources/data_visualisation/data_visualisation_with_ggplot2/"><span itemprop="name">Visualisation with ggplot2</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Data visualisation with tidyverse</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_bZGK theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_l22C">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Data visualisation with tidyverse</h1><p>In this tutorial we will explore data visualisation using the R packages
<a href="https://dplyr.tidyverse.org" target="_blank" rel="noopener noreferrer"><code>dplyr</code></a> and <a href="https://ggplot2.tidyverse.org" target="_blank" rel="noopener noreferrer"><code>ggplot2</code></a>. </p><h2 class="anchor anchorWithStickyNavbar_mojV" id="getting-set-up">Getting set up<a class="hash-link" href="#getting-set-up" title="Direct link to heading">​</a></h2><p><code>dplyr</code> and <code>ggplot2</code> are part of <a href="https://www.tidyverse.org" target="_blank" rel="noopener noreferrer">tidyverse</a>. If you followed the
<a href="/whg-training-resources/prerequisites/tidyverse/">tidyverse installation section</a> you&#x27;ll have this already - if not let&#x27;s install
it now:</p><div class="language-R codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-R codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">install.packages(&quot;tidyverse&quot;) </span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We&#x27;ll use real data on population size, life expectancy and GDP from
<a href="https://www.gapminder.org" target="_blank" rel="noopener noreferrer">gapminder.org</a>, and ecological data from
<a href="https://allisonhorst.github.io/palmerpenguins/" target="_blank" rel="noopener noreferrer">palmerpenguins</a>, so let&#x27;s install those packages
too:</p><div class="language-R codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-R codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">install.packages(&quot;gapminder&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">install.packages(&quot;palmerpenguins&quot;)</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Lastly to make good-looking plots we need cool colour palettes - <a href="https://colorbrewer2.org" target="_blank" rel="noopener noreferrer">Color
Brewer</a> is one of these so let&#x27;s install:</p><div class="language-R codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-R codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">install.packages(&quot;RColorBrewer&quot;)</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Load these into a running R session:</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">library(ggplot2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">library(dplyr)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">library(palmerpenguins)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">library(RColorBrewer)</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As a last step we are going to default to a &#x27;bw&#x27; style of plots, so let&#x27;s set out <code>ggplot2</code> theme now:</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">ggplot2::theme_set(theme_bw())</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="a-first-look-at-gapminder-data-using-ggplot">A first look at <code>gapminder</code> data using ggplot<a class="hash-link" href="#a-first-look-at-gapminder-data-using-ggplot" title="Direct link to heading">​</a></h2><p>We&#x27;ll use real population data from <a href="https://www.gapminder.org" target="_blank" rel="noopener noreferrer">gapminder.org</a>. To load it, load
the <code>gapminder</code> library: <code>library(gapminder)</code></p><p>The gapminder data is now in a variable called <code>gapminder</code> - we&#x27;ll use this a lot so let&#x27;s start by
renaming it to something shorter and taking a look:</p><div class="language-{r codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-{r codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">d &lt;- gapminder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">View(d)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># or just head(d) if not in RStudio</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The data contains measurements of life expectancy, population size, and gross domestic product
(GDP) per capita for different years. The simplest way to see what&#x27;s in there is to create some
summaries using the <code>table</code> function:</p><div class="language-{r codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-{r codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">table( d$year )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">length( unique( d$country ))</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Evidently the data contains entries for 12 years (with 5-year gaps between) and 142 countries.
Are all 142 countries represented at all 12 timepoints?</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">stopifnot( nrow(d) == (12 * 142) )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">View( table(d$country, d$year) )</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Yes they are!</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="a-warmup-plot">A warmup plot<a class="hash-link" href="#a-warmup-plot" title="Direct link to heading">​</a></h3><p>As a warmup let&#x27;s use <code>ggplot</code> to show the distribution of the continuous variables in the data:</p><div class="language-R codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-R codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">p = ggplot( data = d )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print( p + geom_histogram( aes( x = lifeExp ), bins = 25 ))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print( p + geom_histogram( aes( x = gdpPercap ), bins = 25 ))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print( p + geom_histogram( aes( x = pop ), bins = 25 ))</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This code illustrates how ggplot2 works: it creates a plot object (<code>p</code> above) that is associated
with some data; then &#x27;layers&#x27; are added to draw things, such as the histogram layer above. What&#x27;s
more, the layers are associated with <em>aesthetic mappings</em> (<code>aes()</code> in the above) which tell ggplot
how the data variables should be mapped onto visual parameters (that is, things like bar height,
point size or colour, say.)  It should look something like this:</p><p><img loading="lazy" alt="img" src="/whg-training-resources/assets/images/pop1-1810abdae730d771998235a23fc6bf24.png" width="500" height="300" class="img_E7b_"></p><p>A less obvious but essential feature is that the way these data -&gt; visual mappings are presented is
governed by <em>scales</em>. In the above, the scales are implicit (both x and y scales are linear). But
for example, we could alter the <code>x</code> scale of our plot so that bars are drawn in log space:</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">print(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    + geom_histogram( aes( x = pop), bins = 25 )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    + scale_x_log10()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="img" src="/whg-training-resources/assets/images/pop2-0ff66149bb0126fa312589bbf8757086.png" width="400" height="300" class="img_E7b_"></p><p>Compare these last two plots - it might take you a few moments to see exactly what has happened. If
you compare the x axes you&#x27;ll see that they both have the same overall range - they go roughly up
to <code>1e09</code> (whjich of course means <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>×</mo><mn>1</mn><msup><mn>0</mn><mn>9</mn></msup></mrow><annotation encoding="application/x-tex">1\times 10^9</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.8141em"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span></span></span></span></span></span></span></span></span>, i.e. 1 billion.) But in the second plot every
tick represents a point 10 times larger than the one below, that is, it is a log scale, while in
the first version the scale is linear.</p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Questions</h5></div><div class="admonition-content"><ol><li><p>Which version of the plot does a better job of presenting the data?</p></li><li><p>Look at the histogram bars.  Is the histogram binning done <em>before</em> the transformation to log-scale, or after it?</p></li></ol></div></div><p>A subtly different plot is produced if we <em>log-transform the data</em> instead of changing the scale:</p><div class="language-R codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-R codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">print(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    + geom_histogram( aes( x = log10(pop)), bins = 25 )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The plotted bars themselves look identical, but if you look closely you&#x27;ll see the X axis scale has
changed to reflect the log values instead. Which one of these is better probably depends on the context.</p><p>For me, neither of the above plots is perfect - I want a plot that can be understood at a glance,
which means including very clear axis labels. Something like:</p><div class="language-R codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-R codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">print(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    + geom_histogram( aes( x = pop), bins = 25 )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    + scale_x_log10(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        breaks = 10^c( 5, 6, 7, 8, 9 ),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        labels = c(  &quot;100 thousand&quot;, &quot;1 million&quot;, &quot;10 million&quot;, &quot;100 million&quot;, &quot;1 billion&quot; )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    + xlab( &quot;Population size&quot; )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    + ylab( &quot;Number of countries&quot; )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="img" src="/whg-training-resources/assets/images/pop4-4597fe8cd34500edaa77f80320440b9f.png" width="400" height="300" class="img_E7b_"></p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Question</h5></div><div class="admonition-content"><p>Most countries in this data have between about 1 and 100 million individuals in - a few have much
larger or smaller populations. Only two countries have populations larger than a billion. What are
they? Try finding out:</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">d[ d$pop &gt; 1E9 &amp; d$year == &#x27;2007&#x27;, ]</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div><p>In the rest of this tutorial we&#x27;ll use ggplot2 to explore the gapminder dataset in more detail. </p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><p>As
with other R objects, you can find documentation on ggplot2 using R&#x27;s in-built help - for example
to find out how the above works:</p><div class="language-R codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-R codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">?scale_x_log10</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ggplot2 also has <a href="https://ggplot2.tidyverse.org" target="_blank" rel="noopener noreferrer">extensive online documentation</a> including a useful
cheatsheet.</p></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="the-distribution-of-gdp-per-capita">The distribution of GDP per capita.<a class="hash-link" href="#the-distribution-of-gdp-per-capita" title="Direct link to heading">​</a></h2><p>In the rest of this tutorial we&#x27;ll show various ways to create good-looking visualisations with
this data.  Let&#x27;s get started.</p><p>Histograms are ok - they summarise the empirical distribution of data in a largely transparent way.
However they look a bit jaggedy - the true distribution is probably a lot smoother than that. One
option is instead to plot a <em>smoothed histogram</em>, or <em>density plot</em>. That&#x27;s easy with ggplot -
let&#x27;s plot the GDP per capita this way:</p><div class="language-{r codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-{r codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">p2_1 &lt;- ggplot(data = d, mapping = aes(x = gdpPercap)) +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  geom_density() +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  labs(x = &quot;GDP per capita&quot;, y = &quot;Density&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p2_1</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="img" src="/whg-training-resources/assets/images/gdp_density_1-8338dee70ce220736646637685f9adee.png" width="400" height="300" class="img_E7b_"></p><p>As before let&#x27;s change the scale of the x-axis to a log scale</p><div class="language-{r codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-{r codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">p2_1 + scale_x_continuous(trans = &quot;log10&quot;) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># or scale_x_log10()</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>...and make the axis breaks prettier</p><div class="language-{r codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-{r codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">p2_1 + scale_x_continuous(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    trans = &quot;log10&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    breaks = c(0, 1000, 5000, 10000, 50000, 150000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="img" src="/whg-training-resources/assets/images/gdp_density_2-f1df37689ea009ab677046e7cf2ccc23.png" width="400" height="300" class="img_E7b_"></p><p>Nice! But hmm... this is a bit odd looking - it has has at least two bumps. Let&#x27;s next try to see
if this is caused by the distribution of GDP per capita differing in different continents.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="the-distribution-of-gdp-per-capita-by-continent">The distribution of GDP per capita, by continent.<a class="hash-link" href="#the-distribution-of-gdp-per-capita-by-continent" title="Direct link to heading">​</a></h2><p>Now we have another variable we want to add: continent. In a density plot, we can&#x27;t add another
variable along the y-axis - so another way to show a different variable is to use colour.</p><p>Here, I assign both color and fill to continent to shade the area under the density plot.</p><div class="language-R codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-R codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">p2_2a &lt;- ggplot(data = d, mapping = aes(x = gdpPercap, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                        color = continent,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                        fill = continent)) +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # the &quot;alpha&quot; parameter changes the transparency of the fill</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # the &quot;size&quot; parameter changes the thickness of the lines</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  geom_density(alpha = 0.2, size = 1) +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # keep the log scaling we applied previously</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  scale_x_continuous(trans = &quot;log10&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     breaks = c(0, 1000, 5000, 10000, 50000, 150000)) +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # change the labels for color and fill (which label the legend)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  labs(x = &quot;GDP per capita&quot;, y = &quot;Density&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       color = &quot;Continent&quot;, fill = &quot;Continent&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p2_2a</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="img" src="/whg-training-resources/assets/images/gdp_density_by_continent-e3795d60f612f9cbc6e292b06f3f1cec.png" width="500" height="300" class="img_E7b_"></p><p>Let&#x27;s change the colour scheme. People who are colour-blind do science, so let&#x27;s try to keep plots
colour-blind friendly</p><div class="language-{r codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-{r codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">display.brewer.all(colorblindFriendly = T)</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Since the continents are nominal (not ordered), we should use one of the qualitative color palettes
(Set2 or Dark2) rather than a sequential one.</p><div class="language-{r codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-{r codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">p2_2a + scale_color_brewer(palette = &quot;Dark2&quot;) +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  scale_fill_brewer(palette = &quot;Dark2&quot;)</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="bring-on-the-violins">Bring on the violins<a class="hash-link" href="#bring-on-the-violins" title="Direct link to heading">​</a></h3><p>Density plots like this look kindof nice, but can be difficult to interpret with many groups
overlaid over each other.  Another way to plot multiple densities is a <em>violin plot</em>.</p><p>To make one, we&#x27;ll reorganise the plot to have the continent on the x axis and the gdp distribution
on the y axis.  And, just for ease of identification we&#x27;ll keep the colours as well:</p><div class="language-{r codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-{r codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">p2_2b &lt;- ggplot(data = d, mapping = aes(x = continent,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                        y = gdpPercap,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                        color = continent,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                        fill = continent)) +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  geom_violin() +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  scale_y_continuous(trans = &quot;log10&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     breaks = c(0, 1000, 5000, 10000, 50000, 150000)) +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  scale_color_brewer(palette = &quot;Dark2&quot;) +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  scale_fill_brewer(palette = &quot;Dark2&quot;) +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  labs(x = &quot;Continent&quot;, y = &quot;GDP per capita&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p2_2b</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="img" src="/whg-training-resources/assets/images/gdp_violin_by_continent-eaaf39e1e42215d275100d48a4dd8b40.png" width="500" height="300" class="img_E7b_"></p><p>We can also get rid of the legend since it doesn&#x27;t add any new information:</p><div class="language-{r codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-{r codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">p2_2b + theme(legend.position = &quot;none&quot;)</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Note</h5></div><div class="admonition-content"><p>I like this plot with colours, but it does break one of the <strong>cardinal rules of data viz</strong>. This is
that it&#x27;s best to map one feature of the data to one aesthetic (whereas here we have mapped
continent to two: the x axis and colour at the same time.) Arguably as a <em>scientific plot</em> (as
opposed to a presentation tool) this is better without the colours:</p><div class="language-R codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-R codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">print(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ggplot(data = d, mapping = aes(x = continent, y = gdpPercap))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    + geom_violin( fill = &#x27;grey&#x27; )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    + scale_y_continuous(trans = &quot;log10&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                       breaks = c(0, 1000, 5000, 10000, 50000, 150000))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    + labs(x = &quot;Continent&quot;, y = &quot;GDP per capita&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="img" src="/whg-training-resources/assets/images/gdp_violin_by_continent_grey-db3065b6687c9351a014c379c7c958dd.png" width="400" height="300" class="img_E7b_"></p><p>...because the colours distract from the distributions. (But to demo the possibilities we&#x27;ll stick
with the colours for now.)</p></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="adding-summary-statistics">Adding summary statistics<a class="hash-link" href="#adding-summary-statistics" title="Direct link to heading">​</a></h3><p>These violins are essentially vertically-plotted, back-to-back histograms. They are pretty useful
and look good, but don&#x27;t directly provide any quantification. To improve that, let&#x27;s also add
some summary statistics such as the median and the inter-quartile range (IQR) as a boxplot on top
of the violins. Remember that we set the fill and color to match continents in the overall plot
aesthetics, so if we don&#x27;t override that here, the overlaid boxplots will have the same fill and
color as the violins.</p><div class="language-{r codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-{r codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">p2_2b + </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  geom_boxplot(width = 0.1, color = &quot;black&quot;, fill = &quot;white&quot;) +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  theme(legend.position = &quot;none&quot;)</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="img" src="/whg-training-resources/assets/images/gdp_violin_by_continent_2-a7682fbefc4bbbbc53715bfcb860c6b3.png" width="400" height="300" class="img_E7b_"></p><p>Sweet! This illustrates an important feature of ggplot2: the aesthetic mapping can be set on the
plot object itself, but can also be set (or overridden) seperately for each layer, allowing great
flexibility in the plot appearance.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="reordering-values">Reordering values<a class="hash-link" href="#reordering-values" title="Direct link to heading">​</a></h3><p>To make this plot easier to read, let&#x27;s order the plots by median GDP per capita.</p><p>To do this in ggplot takes a bit of data manipulation - essentially, we tell ggplot what order we
want continents in by ordering them in the data itself. To do this we will <em>reorder the levels of
the <code>continent</code> variable</em>. This works because <code>continent</code> is actually a <strong>factor</strong> - discrete
values with a specific set of levels.  You can see them using the <code>levels</code> function:</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">levels(d$continent)</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Right now they are in alphabetical order. Let&#x27;s use <code>dplyr</code> to add a new column with the same
continent in, but now ordered by per capita gdp:</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">d$orderedContinent = reorder( d$continent, d$gdpPercap, FUN = median )</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You should see something like:</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain"># A tibble: 1,704 × 7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   country     continent  year lifeExp      pop gdpPercap orderedContinent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt; &lt;fct&gt;           </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 1 Afghanistan Asia       1952    28.8  8425333      779. Asia            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 2 Afghanistan Asia       1957    30.3  9240934      821. Asia            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 3 Afghanistan Asia       1962    32.0 10267083      853. Asia            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 4 Afghanistan Asia       1967    34.0 11537966      836. Asia            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 5 Afghanistan Asia       1972    36.1 13079460      740. Asia            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 6 Afghanistan Asia       1977    38.4 14880372      786. Asia            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 7 Afghanistan Asia       1982    39.9 12881816      978. Asia            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 8 Afghanistan Asia       1987    40.8 13867957      852. Asia            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 9 Afghanistan Asia       1992    41.7 16317921      649. Asia            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">10 Afghanistan Asia       1997    41.8 22227415      635. Asia            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># … with 1,694 more rows</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ℹ Use `print(n = ...)` to see more rows</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Importantly the new variable is in a different order:
$ levels(d$orderedContinent)
<!-- -->[1]<!-- --> &quot;Africa&quot;   &quot;Americas&quot; &quot;Asia&quot;     &quot;Europe&quot;   &quot;Oceania&quot; </p><p>So let&#x27;s plot - don&#x27;t forget to update to use the new <code>orderedContinent</code> variable:</p><div class="language-{r codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-{r codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">  ggplot(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    data = d,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mapping = aes(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      x = orderedContinent,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      y = gdpPercap,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      color = orderedContinent,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      fill = orderedContinent)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ) +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  geom_violin() +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  geom_boxplot( width = 0.1, color = &quot;black&quot;, fill = &quot;white&quot; ) +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  scale_y_continuous(trans = &quot;log10&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     breaks = c(0, 1000, 5000, 10000, 50000, 150000)) +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  scale_color_brewer(palette = &quot;Dark2&quot;) +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  scale_fill_brewer(palette = &quot;Dark2&quot;) +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  labs(x = &quot;Continent&quot;, y = &quot;GDP per capita&quot;) +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  theme(legend.position = &quot;none&quot;)</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="img" src="/whg-training-resources/assets/images/gdp_violin_by_continent_3-eef40ee7c82b728c4fe0e5cc94c238a3.png" width="400" height="300" class="img_E7b_"></p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Note</h5></div><div class="admonition-content"><p>A fancier way to make these data manipulations is to use <code>dplyr</code> to &quot;pipe&quot; the data through
mutating functions. The <code>%&gt;%</code> syntax is used for this (kindof similar to how the <code>|</code> character is
used in the UNIX shell).  Mutating the dataframe on the fly would look like this:</p><div class="language-R codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-R codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">d %&gt;% mutate(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    orderedContinent = reorder(continent, gdpPercap, FUN = median)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>It&#x27;s also possible to pipe the output straight into ggplot - in this case we skip the <code>data</code>
argument as the data is piped in:</p><div class="language-R codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-R codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">d %&gt;% mutate(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    orderedContinent = reorder(continent, gdpPercap, FUN = median)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">) %&gt;% ggplot(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mapping = aes( ... )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...(etc.)</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Whether this is clearer or not is a matter of personal preference - it certainly can make for
shorter code.</p></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="is-gdp-related-to-life-expectancy">Is gdp related to life expectancy?<a class="hash-link" href="#is-gdp-related-to-life-expectancy" title="Direct link to heading">​</a></h3><p>In the above we&#x27;ve been looking at the distribution of gdp across all years in the data.</p><p>But now let&#x27;s focus on a single year:</p><div class="language-{r codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-{r codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">d07 &lt;- d[d$year == 2007, ]</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>and ask if the variables are related to each other.</p><p>The simplest and often best way to show the relationship between two variables is a <em>scatter plot</em>.
A basic scatter plot is easy:</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">print(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ggplot( data = d07, aes( x = gdpPercap, y = lifeExp ))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  + geom_point()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  + scale_x_continuous(trans = &quot;log10&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="img" src="/whg-training-resources/assets/images/scatterplot_1-117e1daf7d2f8f72c5613774d9a0ab1a.png" width="400" height="300" class="img_E7b_"></p><p>However, we already suspect this may differ by continent so let&#x27;s colour by continent - and fix up
the axis labels etc. as we have been doing:</p><div class="language-{r codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-{r codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">p2_3a &lt;- ggplot(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  data = d07,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mapping = aes(x = gdpPercap, y = lifeExp, colour = continent)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">) +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">geom_point() +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scale_color_brewer(palette = &quot;Dark2&quot;) +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># we know GDP per capita is best viewed on a log scale</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">scale_x_continuous(trans = &quot;log10&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     breaks = c(0, 1000, 5000, 10000, 50000, 150000)) +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">labs(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  x = &quot;GDP per capita&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  y = &quot;Life Expectancy&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  color = &quot;Continent&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  title = &quot;Year: 2007&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p2_3a</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="img" src="/whg-training-resources/assets/images/scatterplot_2-29bbcbcf6b24083c5483a215fc89b027.png" width="500" height="300" class="img_E7b_"></p><p>It looks like there is a trend here! let&#x27;s plot some trend lines with geom_smooth - starting with a simple linear model.</p><div class="language-{r codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-{r codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">p2_3a + geom_smooth(method = &quot;lm&quot;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    color = &quot;black&quot;, fill = &quot;grey&quot;)</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="img" src="/whg-training-resources/assets/images/scatterplot_3-2b4cfb00cde1129d5b9fffcf4ffe41d3.png" width="500" height="300" class="img_E7b_"></p><p>We can even fit a separate regression line to each continent.</p><div class="language-{r codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-{r codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">p2_3b = p2_3a + geom_smooth(aes(color = continent, fill = continent),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    method = &quot;lm&quot;) +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  scale_fill_brewer(palette = &quot;Dark2&quot;) +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  labs(color = &quot;Continent&quot;, fill = &quot;Continent&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p2_3b</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="img" src="/whg-training-resources/assets/images/scatterplot_4-f1ca4163879e70d759e60ec5cd299ece.png" width="500" height="300" class="img_E7b_"></p><p>That&#x27;s pretty interesting. In all the continents this data suggests a strong relationship between
per-capita GDP and life expectancy across countries, with (visually at least) similar slopes.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="labelling-points">Labelling points<a class="hash-link" href="#labelling-points" title="Direct link to heading">​</a></h3><p>Some countries seem to buck this trend however.  It would be useful to label them.
Let&#x27;s try that now.  We&#x27;ll use some thresholds based on the above plot to pick countries for labelling:</p><div class="language-R codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-R codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">dat_label &lt;- d07[</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (d07$gdpPercap &gt; 3000 &amp; d07$lifeExp &lt; 50)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  | (d07$gdpPercap &lt; 1000 &amp; d07$lifeExp &gt; 55),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This is countries with high per-capita gdp but low life expectancy, or vice versa - if you look at
this dataframe you&#x27;ll see there are 10 of them. Let&#x27;s add them to our plot:</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">p2_3c &lt;- p2_3b +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># for the label layer, let&#x27;s jsut use the subsetted data.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Setting position nudge moves the labels away from the points</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">geom_text(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  data = dat_label,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  aes(label = country),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  position = position_nudge(x = -0.1, y = -1),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  show.legend = F</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p2_3c</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="img" src="/whg-training-resources/assets/images/scatterplot_labels_1-65362b1d13722a860348c3225f0ac461.png" width="500" height="300" class="img_E7b_"></p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Note</h5></div><div class="admonition-content"><p>Despite the &#x27;nudge&#x27;, some of the labels are still on top of each other. One thing to try is the
<code>geom_text_repel()</code> geom which is provided by the <code>ggrepel</code> package instead.  Install it like this:</p><div class="language-R codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-R codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">install.packages( &#x27;ggrepel&#x27; )</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And now you can write:</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">p2_3b +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># for the label layer, let&#x27;s jsut use the subsetted data.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Setting position nudge moves the labels away from the points</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">geom_text_repel(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  data = dat_label,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  aes(label = country),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  show.legend = F</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="img" src="/whg-training-resources/assets/images/scatterplot_labels_2-8794e24d4468c6102ef7db22a24674a4.png" width="500" height="300" class="img_E7b_"></p><p><code>ggrepel</code> has moved the labels off each other. (Still, it&#x27;s still not totally obvious which points
go with with label. In general you can spend a lot of time getting labels like this in the right
places - we&#x27;ll leave it there for now.)</p></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="saving-your-figures">Saving your figures<a class="hash-link" href="#saving-your-figures" title="Direct link to heading">​</a></h3><p>Make sure you don&#x27;t lose all your hard work - let&#x27;s save the plot to a pdf. (You can also save to
tiff, png, etc., but pdfs have the nice property that they don&#x27;t lose anything due to image
resolution - I suggest using them unless your plot has a huge number of points.)</p><p>You can do this in RStudio by clicking on the <code>Export</code> button just above the plot pane.  Alternatively in R itself:</p><div class="language-R codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-R codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">ggsave(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  plot = p2_3c,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  filename = &quot;gdp_vs_lifeexp_2007.pdf&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  width = 6,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  height = 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Note</h5></div><div class="admonition-content"><p>For pdf files, widths and heights are specified in inches by default. You can change this using the
<code>units</code> argument - see an example below.</p></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="facetting">Facetting<a class="hash-link" href="#facetting" title="Direct link to heading">​</a></h3><p>Our plot only shows one year of the data. What if we want to show all years at once? We&#x27;d like a
way to split the plot into several panes. This is what <em>facets</em> are designed for.</p><p>Let&#x27;s give it a go using the
<a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" target="_blank" rel="noopener noreferrer"><code>facet_wrap()</code></a> command.  This tells
ggplot2 to split up the plot based on the value of a (categorical) variable - and arrange them as
multiple panes wrapping into a larger plot.</p><p>First, let&#x27;s plot the data without the facet applied.</p><div class="language-R codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-R codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">p2_3d &lt;- (</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ggplot(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    data = d,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mapping = aes(x = gdpPercap, y = lifeExp,  color = continent)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ) +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  geom_point() +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  scale_color_brewer(palette = &quot;Dark2&quot;) +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # the scales::comma parameter changes the way axis ticks are displayed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  scale_x_continuous(trans = &quot;log10&quot;, labels = scales::comma) +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  labs(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    x = &quot;GDP per capita&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    y = &quot;Life Expectancy&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    color = &quot;Continent&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p2_3d</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="img" src="/whg-training-resources/assets/images/unfacetted-f7f5f74729c7303940ccc4926fdde528.png" width="500" height="300" class="img_E7b_"></p><p>Not surprisingly it&#x27;s pretty messy because all the data is on the same pane. Now let&#x27;s add the
facet:</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">p2_3d + facet_wrap(~year, nrow = 4, ncol = 3)</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="img" src="/whg-training-resources/assets/images/facetted-100978c20f3dc84f063ffcd1f486ce51.png" width="800" height="600" class="img_E7b_"></p><p>Finally let&#x27;s also save this plot to a <a href="https://en.wikipedia.org/wiki/TIFF" target="_blank" rel="noopener noreferrer">tiff</a> and specify plot
dimensions and resolution - useful for publications:</p><div class="language-R codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-R codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">ggsave(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  plot = p2_3d + facet_wrap(~year, nrow = 4, ncol = 3),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  filename = &quot;gdp_vs_lifeexp_allyears.tiff&quot;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  units = &quot;cm&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  height = 23,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  width = 16.8,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  dpi = 300</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Questions</h5></div><div class="admonition-content"><p>One of the Asian countries is a huge outlier - very high GDP from the 1950s onwards.  Which is it?</p><p>Another country has especially low life expectancy 1992 - which is it?</p><p>What happens if you facet by country instead is this useful?</p><p>Can you add outlier labels to this plot as we did before?</p></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="other-plots">Other plots<a class="hash-link" href="#other-plots" title="Direct link to heading">​</a></h3><p>There are of course lots of other ways we could visualise this data -
for example here is a plot using <code>geom_line</code> to focus on a few countries over time:</p><div class="language-R codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-R codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">print( </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ggplot(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    data = d[ d$country %in% c( &#x27;Japan&#x27;, &#x27;China&#x27;, &#x27;Norway&#x27;, &#x27;United States&#x27;, &#x27;Iraq&#x27; ), ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mapping = aes( x = gdpPercap, y = lifeExp, colour = country )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  + geom_line()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  + geom_point()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  + geom_text( aes( label = year ), nudge_x = 0, nudge_y = 1, size = 2 )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  + scale_color_brewer(palette = &quot;Dark2&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="img" src="/whg-training-resources/assets/images/lines-d174bc7471887f510acc7659d2c66d01.png" width="500" height="300" class="img_E7b_"></p><p>The sky is the limit - hopefully this tutorial has given you a start in how to explore the
possibilites. Read the <a href="https://ggplot2.tidyverse.org" target="_blank" rel="noopener noreferrer">ggplot2 documentation</a> for many more ideas.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="part-3---try-it-yourself">Part 3 - Try it yourself!<a class="hash-link" href="#part-3---try-it-yourself" title="Direct link to heading">​</a></h2><div class="language-{r codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-{r codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token plain">d &lt;- penguins</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Feel free to copy code from previous sections, or come up with your own.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/whg-training/whg-training-resources/edit/main/docs/data_visualisation/data_visualisation_with_ggplot2/dataviz.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/whg-training-resources/data_visualisation/data_visualisation_with_ggplot2/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Visualisation with ggplot2</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/whg-training-resources/next_generation_sequencing/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Next-generation sequencing</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#getting-set-up" class="table-of-contents__link toc-highlight">Getting set up</a></li><li><a href="#a-first-look-at-gapminder-data-using-ggplot" class="table-of-contents__link toc-highlight">A first look at <code>gapminder</code> data using ggplot</a><ul><li><a href="#a-warmup-plot" class="table-of-contents__link toc-highlight">A warmup plot</a></li></ul></li><li><a href="#the-distribution-of-gdp-per-capita" class="table-of-contents__link toc-highlight">The distribution of GDP per capita.</a></li><li><a href="#the-distribution-of-gdp-per-capita-by-continent" class="table-of-contents__link toc-highlight">The distribution of GDP per capita, by continent.</a><ul><li><a href="#bring-on-the-violins" class="table-of-contents__link toc-highlight">Bring on the violins</a></li><li><a href="#adding-summary-statistics" class="table-of-contents__link toc-highlight">Adding summary statistics</a></li><li><a href="#reordering-values" class="table-of-contents__link toc-highlight">Reordering values</a></li><li><a href="#is-gdp-related-to-life-expectancy" class="table-of-contents__link toc-highlight">Is gdp related to life expectancy?</a></li><li><a href="#labelling-points" class="table-of-contents__link toc-highlight">Labelling points</a></li><li><a href="#saving-your-figures" class="table-of-contents__link toc-highlight">Saving your figures</a></li><li><a href="#facetting" class="table-of-contents__link toc-highlight">Facetting</a></li><li><a href="#other-plots" class="table-of-contents__link toc-highlight">Other plots</a></li></ul></li><li><a href="#part-3---try-it-yourself" class="table-of-contents__link toc-highlight">Part 3 - Try it yourself!</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">License</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/whg-training-resources/LICENSE/">License</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/whg-training/whg-training-resources" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 University of Oxford.  Built with Docusaurus.</div></div></div></footer></div>
<script src="/whg-training-resources/assets/js/runtime~main.50846bb3.js"></script>
<script src="/whg-training-resources/assets/js/main.1b628545.js"></script>
</body>
</html>